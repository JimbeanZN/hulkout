version: 1.0.{build}
configuration: Debug

image: Visual Studio 2017

pull_requests:
  do_not_increment_build_number: true

branches:
  only:
  - master

before_build:
- dotnet restore ./src/HulkOut.sln
- choco install opencover.portable
- choco install codecov

build:
  project: ./src/HulkOut.sln

after_test:
- OpenCover.Console.exe -register:user -oldstyle -hideskipped:filter -target:"C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\MSTest.exe" -targetargs:"/testcontainer:"".\src\HulkOut.Tests\bin\Debug\net461\HulkOut.Tests.dll" -filter:"+[HulkOut.*]* -[*.Tests]*" -output:"HulkOut_Coverage.xml"
- codecov -f "HulkOut_Coverage.xml"

artifacts:
- path: HulkOut_Coverage.xml
